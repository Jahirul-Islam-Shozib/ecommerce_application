<p-dialog header="Cart"
          [(visible)]="visible"
          [modal]="true"
          [style]="{width: '90vw', height: '90vh'}"
          [dismissableMask]="true"
          [closable]="true"
          (onHide)="onCloseCart()"
>
  <p-tabs [(value)]="activeTab">
    <p-tablist>
      <p-tab value="0">Product Cart</p-tab>
      <p-tab value="1">Checkout</p-tab>
    </p-tablist>

    <p-tabpanel value="0">
      <div class="grid grid-cols-1 md:grid-cols-12 gap-4 py-4">
        <!-- Left Column: 8/12 on md+, full on mobile -->
        <div class="md:col-span-8 h-auto p-2 md:p-4 rounded-lg">
          <div>
            <!-- Header Row -->
            <div class="hidden md:grid md:grid-cols-12 items-center font-semibold text-gray-800 pb-2 text-sm">
              <div class="col-span-6">Items</div>
              <div class="col-span-3 text-center">Quantity</div>
              <div class="col-span-3 text-right">Total</div>
            </div>

            <!-- Item Row -->
            <div *ngFor="let item of cartItems()"
                 class="grid grid-cols-1 md:grid-cols-12 items-start md:items-center border-t border-gray-200 py-4">
              <!-- Item Info -->
              <div class="md:col-span-7 flex justify-between items-start space-x-4">
                <div class="flex gap-4">
                  <img [src]="item.product.imageUrl" alt="Product"
                       class="w-24 h-20 bg-[#F9FEFE] rounded-md border p-2 border-gray-200"/>
                  <div>
                    <p class="font-medium text-gray-800 leading-snug">
                      {{ item.product.name }}
                    </p>
                    <p class="text-sm text-gray-500">{{ item.product.weight }}</p>
                    <p class="text-base font-bold text-gray-800 mt-1">৳{{ item.product.discountedPrice }}</p>
                  </div>
                </div>

                <div class="md:hidden">
                  <button
                    class="w-10 h-10 flex items-center justify-center rounded-md border border-gray-300 hover:bg-gray-100"
                    (click)="remove(item)">
                    <span class="text-xl text-gray-500">×</span>
                  </button>
                </div>
              </div>

              <!-- Quantity -->
              <div class="md:col-span-3 flex md:justify-center justify-between items-center mt-4 md:mt-0">
                <div class="flex items-center border border-gray-300 rounded-md overflow-hidden">
                  <button class="w-10 h-10 text-lg text-gray-700 hover:bg-gray-100" (click)="decrease(item)">−</button>
                  <div class="w-10 text-center border-l border-r border-gray-300 text-gray-800">{{ item.quantity }}
                  </div>
                  <button class="w-10 h-10 text-lg text-gray-700 hover:bg-gray-100" (click)="increase(item)">+</button>
                </div>
                <div class="md:hidden">
                  <p class="text-lg font-semibold text-gray-800">
                    ৳ {{ item.product.discountedPrice * item.quantity }}</p>
                </div>
              </div>

              <!-- Total & Remove -->
              <div class="hidden md:col-span-2 md:flex md:justify-end justify-between items-center gap-4 md:mt-0 mt-2">
                <p class="text-lg font-semibold text-gray-800">৳ {{ item.product.discountedPrice * item.quantity }}</p>
                <button
                  class="w-10 h-10 flex items-center justify-center rounded-md border border-gray-300 hover:bg-gray-100"
                  (click)="remove(item)">
                  <span class="text-xl text-gray-500">×</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: 4/12 on md+, full on mobile -->
        <div class="md:col-span-4 bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
          <!-- Promo Code -->
          <div class="flex items-center border border-teal-200 rounded-md overflow-hidden mb-4">
            <input
              type="text"
              placeholder="Enter Promo Code"
              class="flex-1 px-3 py-2 outline-none text-sm"
            />
            <button
              class="flex items-center gap-1 px-3 py-2 bg-white text-teal-600 font-semibold border-l border-teal-200 hover:text-teal-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-teal-500" fill="none" viewBox="0 0 24 24"
                   stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              Apply
            </button>
          </div>

          <!-- Cost Summary -->
          <div>
            <p class="text-sm font-semibold text-gray-700 mb-2">Cost Summary</p>
            <hr class="border-teal-100 mb-2"/>

            <div class="flex justify-between text-sm mb-2">
              <span>Items Price</span>
              <span class="font-medium">{{ totalPrice }}৳</span>
            </div>
            <div class="flex justify-between text-sm mb-2">
              <span>Vat/Tax</span>
              <span class="text-green-600">+{{ tax }}৳</span>
            </div>
            <div class="flex justify-between text-sm mb-2">
              <span>Discount</span>
              <span class="text-red-500">-{{ discount }}৳</span>
            </div>

            <hr class="border-teal-100 my-3"/>

            <div class="flex justify-between items-center mb-4">
              <span class="text-lg font-semibold">Subtotal:</span>
              <span class="text-lg font-bold text-gray-800">{{ subtotal }}৳</span>
            </div>

            <button (click)="goToCheckout()"
                    class="w-full bg-teal-500 hover:bg-teal-600 text-white text-sm py-2 rounded-md flex items-center justify-center gap-2 transition">
              Proceed to Checkout
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24"
                   stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </button>
          </div>

          <!-- Remove All Link -->
          <div class="text-center mt-4">
            <button class="text-sm text-gray-500 underline hover:text-gray-700" (click)="clearCart()">
              Remove all from Cart
            </button>
          </div>
        </div>
      </div>
    </p-tabpanel>

    <p-tabpanel value="1">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-2 md:p-4">
        <!-- Left Column -->
        <div class="md:col-span-2 space-y-6">
          <!-- Delivery Option -->
          <div class="mt-2 md:mt-0">
            <h2 class="text-gray-800  font-semibold mb-1">Delivery Option</h2>
            <p class="text-sm text-gray-500 mb-3">
              Only self pickup available at this time. Please select your pickup Point.
            </p>
            <p-select
              [options]="pickupPoints"
              [(ngModel)]="selectedPickupPoint"
              placeholder="Select Pickup Point"
              class="w-full text-sm"
              [appendTo]="'body'"
              [panelStyle]="{ 'max-width': '82vw', 'width': '100%' }"
            />
          </div>

          <!-- Delivery Note -->
          <div>
            <h2 class="text-gray-800 font-semibold mb-1">Add Delivery Note</h2>
            <textarea
              placeholder="Type delivery note"
              rows="3"
              class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm resize-none focus:outline-none focus:ring-1 focus:ring-teal-500"
            ></textarea>
          </div>

          <!-- Payment Method -->
          <div>
            <h2 class="text-gray-800 font-semibold mb-3">Payment Method</h2>
            <label
              class="flex items-center border border-gray-300 rounded-md px-4 py-2 cursor-pointer hover:border-teal-500"
            >
              <input type="radio" name="payment" value="cod" class="form-radio text-teal-500" checked/>
              <span class="ml-2 text-sm font-medium text-gray-700">Cash On Delivery</span>
            </label>
          </div>
        </div>

        <!-- Right Column (Cost Summary) -->
        <div class="bg-white border border-gray-200 rounded-lg shadow-sm p-4 h-fit">
          <h3 class="text-gray-800 font-semibold text-sm mb-3">Cost Summary</h3>

          <div class="flex justify-between text-sm mb-2">
            <span>Items Price</span>
            <span class="font-medium">{{ totalPrice }}৳</span>
          </div>
          <div class="flex justify-between text-sm mb-2">
            <span>Vat/Tax</span>
            <span class="text-green-600">+{{ tax }}৳</span>
          </div>
          <div class="flex justify-between text-sm mb-3">
            <span>Discount</span>
            <span class="text-red-500">-{{ discount }}৳</span>
          </div>

          <hr class="my-3 border-gray-100"/>

          <div class="flex justify-between items-center mb-4">
            <span class="text-lg font-semibold">Subtotal:</span>
            <span class="text-lg font-bold text-gray-800">{{ subtotal }}৳</span>
          </div>

          <div class="flex items-center gap-2">
            <button
              (click)="goToProductCart()"
              class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 text-sm py-2 rounded-md flex items-center justify-center gap-2 transition"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-700" fill="none" viewBox="0 0 24 24"
                   stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
              </svg>
              Back
            </button>
            <button (click)="onPlaceOrder()"
                    class="flex-1 bg-teal-500 hover:bg-teal-600 text-white text-sm py-2 rounded-md flex items-center justify-center gap-2 transition"
            >
              Place Order
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24"
                   stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </p-tabpanel>
  </p-tabs>
</p-dialog>

<div class="confirmation-dialog">
  <p-dialog
    [(visible)]="visibleDialog"
    [modal]="true"
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
    [style]="{ width: '30vw' }"
  >
    <div class="bg-white px-4 py-2 pb-4 rounded-lg w-full">
      <div class="flex flex-col items-center">
        <!-- Checkmark Icon -->
        <div class="bg-gray-100 p-6 rounded-full">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            class="w-16 h-16 text-green-600"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 13l4 4L19 7"
            />
          </svg>
        </div>
        <!-- Success Message -->
        <h2 class="text-center md:text-2xl text-xl font-semibold text-green-600 mt-4">Order Submitted Successfully!</h2>
        <!-- Description -->
        <p class="text-center text-sm text-gray-600 mt-3">
          Your order has been successfully submitted. We’ll keep you updated on the mail.
        </p>
      </div>
    </div>
  </p-dialog>
</div>


